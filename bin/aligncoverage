#!/usr/bin/env python

# Given 454 Project directory path
# Spit out all low coverage bases for the refrence listed highest in 454RefStatus
import os
import os.path
import sys
from argparse import ArgumentParser

from wrairlib.fff.refstatus import RefStatus

from coverage.coverage import AlignmentCoverage

def main( ops ):
    ac = AlignmentCoverage( ops.dir, ops.lc )
    for ref, regions in ac.find_low_coverage().items():
        print "Reference %s has the following low coverage regions:" % ref
        for region in sorted( regions ):
            print "\t%s" % region

def getops( ):
    parser = ArgumentParser()

    parser.add_argument( '-d', '--dir', dest='dir', required=True, help='454 Project directory path to find gaps in' )
    parser.add_argument( '-lc', '--low-coverage', dest='lc', default=10, help='What is considered low coverage[Default: 10 reads]' )

    ops = parser.parse_args()
    
    return ops
    
if __name__ == '__main__':
    ops = getops()
    main( ops )
